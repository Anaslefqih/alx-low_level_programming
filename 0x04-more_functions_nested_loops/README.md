more functions and nasted loops
